{% extends "base/layout.html" %}

{% load staticfiles %}

{% block assets %}

<script src="{{ settings.STATIC_LIB_BASE }}jquery/dist/jquery.min.js"></script>

<link href="{{ settings.STATIC_LIB_BASE }}bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="{{ settings.STATIC_LIB_BASE }}bootstrap/dist/js/bootstrap.min.js"></script>

<!-- <link href="{{ settings.STATIC_LIB_BASE }}datatables/media/css/jquery.dataTables.min.css" rel="stylesheet">
<script src="{{ settings.STATIC_LIB_BASE }}datatables/media/js/jquery.dataTables.min.js"></script>
 -->
<link rel="stylesheet" href="{% static "base/base.css" %}"/>
<link rel="stylesheet" href="{% static "workflow/css/table_page_new.css" %}"/>
<script src="{% static "workflow/js/reports.js" %}"></script>

{% endblock %}

{% block body %}

<div class="container">

    <div class="row">
        <div class="col-md-12">
            <div class="pull-right">
            <a class="btn btn-success" href="/workflow/add_report"><i class="fa fa-plus"></i>&nbsp; New Report</a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <form id="search" method="get">
                <input type="text" name="search" value="{% if search_get_param %}{{search_get_param}}{% endif %}">
                <button form="search" class="btn btn-primary" type="submit">Search</button>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            {% if pagination_keys %}
                <div class="pagination">
                    <ul>
                        {% for pagination_key in pagination_keys %}
                            <li class="{% if pagination_key.0 == active_page_number %}active{% endif %}"><a class="{% if pagination_key.1 == None %}inactive{% endif %}" href="{% if pagination_key.1 == None %}#{% else %}/workflow/reports/?sort_key={{ sort_key }}&amp;sort_order={{ sort_order }}&amp;offset={{ pagination_key.1}}{% if search_get_param %}&amp;search={{ search_get_param }}{% endif %}&amp;limit={{ limit }}{% endif %}">{{ pagination_key.0 }}</a></li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <button form="delete-selected" class="btn btn-danger" type="submit">Delete selected</button>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 table-responsive">
            <form id="delete-selected" method="post">
                {% csrf_token %}
                <input type="hidden" name="sort_key" value="{{ sort_key }}">
                <input type="hidden" name="sort_order" value="{{ sort_order }}">
                <input type="hidden" name="search_get_param" value="{{ search_get_param }}">
                <input type="hidden" name="offset" value="{{ offset }}">
                <input type="hidden" name="limit" value="{{ limit }}">

                <div class="table">
                    <div class="table-row">                               
                        <div class="table-header-cell"></div>
                        <a
                            href="?offset={{ offset }}&amp;limit={{ limit }}&amp;{% if search_get_param %}search={{ search_get_param }}{% endif %}&amp;sort_key=reported_datetime&amp;{% if sort_key == 'reported_datetime' and sort_order == 'DESC' %}sort_order=ASC{% else %}sort_order=DESC{% endif %}"
                            class="{% if sort_key == 'reported_datetime' %}active {% if sort_order = 'DESC' %}desc {% else %}asc {% endif %}{% endif %}table-header-cell"
                            >Received{% if sort_key == 'reported_datetime' %}{% if sort_order = 'DESC' %}&nbsp;&nbsp;<i class="fa fa-caret-down"></i>{% else %}&nbsp;&nbsp;<i class="fa fa-caret-up"></i>{% endif %}{% endif %}</a>
                        <a
                            href="?offset={{ offset }}&amp;limit={{ limit }}&amp;{% if search_get_param %}search={{ search_get_param }}{% endif %}&amp;sort_key=reporter_name&amp;{% if sort_key == 'reporter_name' and sort_order == 'ASC' %}sort_order=DESC{% else %}sort_order=ASC{% endif %}"
                            class="{% if sort_key == 'reporter_name' %}active {% if sort_order = 'DESC' %}desc {% else %}asc {% endif %}{% endif %}table-header-cell"
                            >Reporter{% if sort_key == 'reporter_name' %}{% if sort_order = 'DESC' %}&nbsp;&nbsp;<i class="fa fa-caret-down"></i>{% else %}&nbsp;&nbsp;<i class="fa fa-caret-up"></i>{% endif %}{% endif %}</a>
                        <a
                            href="?offset={{ offset }}&amp;limit={{ limit }}&amp;{% if search_get_param %}search={{ search_get_param }}{% endif %}&amp;sort_key=problem_address&amp;{% if sort_key == 'problem_address' and sort_order == 'ASC' %}sort_order=DESC{% else %}sort_order=ASC{% endif %}"
                            class="{% if sort_key == 'problem_address' %}active {% if sort_order = 'DESC' %}desc {% else %}asc {% endif %}{% endif %}table-header-cell"
                            >Address{% if sort_key == 'problem_address' %}{% if sort_order = 'DESC' %}&nbsp;&nbsp;<i class="fa fa-caret-down"></i>{% else %}&nbsp;&nbsp;<i class="fa fa-caret-up"></i>{% endif %}{% endif %}</a>
                        <a
                            href="?offset={{ offset }}&amp;limit={{ limit }}&amp;{% if search_get_param %}search={{ search_get_param }}{% endif %}&amp;sort_key=problem&amp;{% if sort_key == 'problem' and sort_order == 'ASC' %}sort_order=DESC{% else %}sort_order=ASC{% endif %}"
                            class="{% if sort_key == 'problem' %}active {% if sort_order = 'DESC' %}desc {% else %}asc {% endif %}{% endif %}table-header-cell"
                            >Description{% if sort_key == 'problem' %}{% if sort_order = 'DESC' %}&nbsp;&nbsp;<i class="fa fa-caret-down"></i>{% else %}&nbsp;&nbsp;<i class="fa fa-caret-up"></i>{% endif %}{% endif %}</a>
                        <a
                            href="?offset={{ offset }}&amp;limit={{ limit }}&amp;{% if search_get_param %}search={{ search_get_param }}{% endif %}&amp;sort_key=notes&amp;{% if sort_key == 'notes' and sort_order == 'ASC' %}sort_order=DESC{% else %}sort_order=ASC{% endif %}"
                            class="{% if sort_key == 'notes' %}active {% if sort_order = 'DESC' %}desc {% else %}asc {% endif %}{% endif %}table-header-cell"
                            >Notes{% if sort_key == 'notes' %}{% if sort_order = 'DESC' %}&nbsp;&nbsp;<i class="fa fa-caret-down"></i>{% else %}&nbsp;&nbsp;<i class="fa fa-caret-up"></i>{% endif %}{% endif %}</a>
                    </div>
                    {% for report in reports_data %}
                        <a class="table-row" href="/workflow/report/{{ report.0 }}">
                            <div class="table-cell table-cell-checkbox"><div><input type="checkbox" name="to_delete" value="{{ report.0 }}"></div></div>
                            <div class="table-cell">{{ report.1 }}</div>
                            <div class="table-cell">{{ report.2 }}</div>
                            <div class="table-cell">{{ report.3 }}</div>
                            <div class="table-cell">{{ report.4 }}</div>
                            <div class="table-cell">{{ report.5 }}</div>
                        </a>
                    {% endfor %}
                </div>
            </form>
        </div>
    </div>

</div>  <!-- End container -->
{% endblock %}
